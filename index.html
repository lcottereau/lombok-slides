<!doctype html>
<html lang="fr">

	<head>
		<meta charset="utf-8">

		<title>Les «&#8239;design patterns&#8239;» clés en main avec Lombok. La maintenabilité en bonus.</title>

		<meta name="description" content="Une présentation sur la bibliothèque d'injection de design patterns en java, Lombok">
		<meta name="author" content="Laurent Cottereau">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="reveal/css/reveal.min.css">
		<link rel="stylesheet" href="reveal/css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="reveal/lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'reveal/css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="reveal/lib/js/html5shiv.js"></script>
		<![endif]-->

		<style>
		    li.email {
		        list-style-image: url('img/icon-email.png');
		    }
		    li.linkedin {
		        list-style-image: url('img/icon-linkedin.png');
		    }
		    li.twitter {
		        list-style-image: url('img/icon-twitter.png');
		    }
		    li.github {
		        list-style-image: url('img/icon-github.png');
		    }
		    .reveal a:not(.image) {
		        color: white;
		    }
		    .reveal a:not(.image):hover {
		        text-decoration: underline;
		    }
		    html:not(.no-background) .present {
		    	background-color: rgba(0, 0, 0, 0.8);
		    	border-radius: 10px;
		    }
		</style>
	</head>

	<body>

		<div class="reveal">

			<div class="slides">
				<section data-background="img/slide-lombok.jpg" data-state="no-background">
					<h1>Lombok</h1>
					<p>Les «&#8239;<span lang="en">design patterns</span>&#8239;» clés en main</p>
					<p>La maintenabilité en bonus</p>
				</section>

				<section>
					<aside class="notes">
						<p>Vous et mois, nous avons tous les mêmes problèmes. (blague sur un problème des dév ? peut-être sur le vente liée avec apple ?) On va faire du CRUD en informatique de gestion, du MVC en applications web, (autres exemples). Et là je vous en parle avec des acronymes et vous voyez (probablement) de quoi je parle : les design-patterns (motifs d'architecture logicielle) c'est ça : des bouts d'architecture logicielle utiles pour répondre à un besoin donné <em>classique</em>, auquels on donne un nom.</p>

						<p>"J'ai un ami" étudiant développeur qui a eu des cours sur les design patterns mais a trouvé ça très pénible, rébarbatif et abstrait (il dit que c'est la faut des professeurs qui lui ont asséné des piles de livres sans fin mais c'est peut-être aussi qu'il était occupé à draguer au bar de l'université) et ne s'en est pas trop préoccupé. Malgré tout, il a eu son diplôme et il a commencé à travailler dans le concret, et finit par se faire son petit répertoire de code et d'habitudes qu'il réutilise de projet en projet sans réaliser qu'il est en train de réinventer la roue. Puis le vocabulaire revenant sans cesse, il réalise alors que ce qu'il a fait a été mieux fait ailleurs. Ce qu'il a n'est au mieux pas terrible, et parfois complètement faux (qui a déjà essayé de réimplémenter des patterns de sécurité ?).</p>

						<p>Pour un grand nombre de patterns, il y a une sorte de consensus du monde professionel, voire des standards documentés (java beans). Dans ces cas-là, on se retrouve à prendre un livre de design patterns, chercher celui qui lui convient et à recopier le code et on finit même par les connaître par coeur (lazy-loading). Pour le développeur (feignant donc), c'est absolument insupportable. Les IDE ont résolu ça depuis pas mal de temps : des outils permettent de générer du code. Mais cela résiste (très) mal aux remaniements. Parfois guava, apache-commons, java 7 ont introduit des méthodes supplémentaires (faire un exemple) mais c'est lourd à appeler. C'est là que lombok intervient : le principe consiste à décider de l'utilisation d'un design pattern via une annotation sur une classe, méthode ou attribut. Le code est généré à la compilation.</p>

						<p>Petit point sur l'utilisation. Si vous utilisez un autre IDE que Netbeans, il y a une petite installation à faire pour qu'il découvre le code source intermédiaire. Ensuite, de manière générale, le jar dans le classpath à la compilation est suffisant et rien n'est nécessaire au runtime. Pour maven, c'est facile :</p>

						<blockquote><code>
							&lt;dependency>
							&nbsp;&nbsp;&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
							&nbsp;&nbsp;&lt;artifactId&gt;lombok&lt;/artifactId&gt;
							&nbsp;&nbsp;&lt;version&gt;1.12.6&lt;/version&gt;
							&nbsp;&nbsp;&lt;scope&gt;provided&lt;/scope&gt;
							&lt;/dependency&gt;
						</code></blockquote>

						<p>Avant (tempête, brouillard, etc...) : une grosse classe JPA très longue avec toString, equals, hashcode, getters (dont un lazy), setters, constructeurs avec arguments requis. Etapes avec météo qui s'améliore pour chacun des cas. Dernier slide sur grand ciel bleu avec l'annotation data</p>

						<p>D'autres qui peuvent être utiles</p>

						<ul>
							<li>Le Builder permet de disposer facilement d'une interface fluide d'instanciation (exemple avec un chouette thème, superman ?)</li>
							<li>La délégation permet de faire suivre à une autre classe l'exécution d'une tâche. C'est souvent utile en architecture logicielle et devrait aider à la lisibilité mais la plomberie nécessaire est lourdre</li>
							<li>Value permet de documenter et générer une classe immutable</li>
							<li>XXXLog permet de mettre en cohérence la gestion des logs (juste une ligne)</li>
						</ul>

						<p>De nombreuses annotations sont disponibles : stables, expérimentaux (officiels) et playground (externes au projet). On peut en effet créer ses propres extensions</p>

						<p>Mais attention ! Les premiers pas avec lombok ont tendance à dégénérer. Tout le monde sait ce qu'un getter fait et comment c'est fait. Des annotations plus complexes ne seront pas forcément évidentes et peuvent compliquer la lisibilité, voire les performances (des toString qui bouclent ou sur des collections par exemple). Si c'est quelque chose de spécifique au projet ou bien quelque chose dont l'implémentation n'est pas connue, il vaut peut-être mieux regarder du côté de l'aspect ou d'autres architectures. Par ailleurs, le debug n'est pas facile puisque l'IDE ne dispose pas du code source</p>

						<p>Mais à ces points d'attention près, rien ne vous empêche d'essayer : on peut mettre en place de manière échelonnée sur un projet, et on n'est jamais enfermé car <code>delombok</code> permet toujours de récupérer le code source correspondant. Et le gain est tout de suite perceptible : d'abord parce que c'est plus rapide pour coder une classe mais ce n'est pas ça le principal.</p>

						<p>Surtout, c'est un outil excellent pour la maintenabilité : la lisibilité est facilité en se concentrant sur la plus-value du code (différenciateur par rapport aux autres produits) sans rogner sur la capacité à remanier. L'utilisation des annotations permet de se concentrer sur l'intention du développeur plutôt que sur l'implémentation.</p>
					</aside>
				</section>

				<section data-background="img/slide-weather-1.jpg">
				</section>
				<section data-background="img/slide-beer.jpg">
					<h1>Crédits</h1>
					<ul>
						<li>Logiciels : 
							<a hreflang="en" href="http://lab.hakim.se/reveal-js/">reveal.js</a>, 
							<a hreflang="en" href="http://simpleicons.org/">simple icons</a>
						</li>
						<li>Photos : 
							<a hreflang="en" href="https://secure.flickr.com/photos/fadilfb/512828077/">Fadil Basymeleh</a>,
							<a hreflang="en" href="http://www.linkedin.com/in/florentmathe">Florent Mathé</a>,
							<a hreflang="en" href="http://www.flickr.com/people/40939157@N03">Nigel Howe</a>,
						</li>
					</ul>
				</section>

				<section data-background="img/slide-dingle.jpg" data-state="no-background">
		            <h1>Merci</h1>
		            <ul>
		              <li class="email"><a href="mailto:laurent@cottereau.name"><code>laurent@cottereau.name</code></a></li>
		              <li class="twitter"><a href="https://twitter.com/lcottereau"><code>@lcottereau</code></a></li>
		              <li class="linkedin"><a href="http://fr.linkedin.com/in/lcottereau/fr"><code>lcottereau</code></a></li>
		              <li class="github"><a hreflang="en" href="https://github.com/lcottereau"><code>lcottereau</code></a></li>
		            </ul>
				</section>

			</div>

		</div>

		<script src="reveal/lib/js/head.min.js"></script>
		<script src="reveal/js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none
				backgroundTransition: 'slide',

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'reveal/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'reveal/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'reveal/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'reveal/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'reveal/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'reveal/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
